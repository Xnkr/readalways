{% load borrow_extras %}
<div class="container">
	{% if results %}
		{% for book in results %}
			{% if forloop.counter0|divisibleby:3 %}
				<div class="row my-2">
					
				{% endif %}
				<div class="col-md-4 card bg-transparent py-2">
					<div class="row">
						<div class="col-md-6">
							<img src="{{ book.book_cover.url }}" width="100%">
						</div>
						<div class="col-md-6">
							<h4>{{ book.book_name }}</h4>
							<h5>By {{ book.book_author }}</h5>
							<h6><strong>Category: </strong>{{ book.book_category }}</h6>
							{% if book.book_genre.all|length %}
								<h6><strong>Genre: </strong>
								{% for genre in book.book_genre.all %}
									{{ genre }}{% if forloop.counter < book.book_genre.all|length %},{% endif %}
								{% endfor %}
							{% endif %}
							{% if book.book_edition %}
								<h6><strong>Edition:</strong>{{book.book_edition}}</h6>
							{% endif %}
							{% if not book.id|request_check:user %}
								<form action="" method="post">
									{% csrf_token %}
									<input type="hidden" name="book_id" value="{{ book.id }}">
									<button type="submit" class="btn btn-success my-2">Request for Book</button>
								</form>
								{% elif book.id|request_check:user %}
								<button type="submit" class="btn btn-secondary my-2" style="cursor:not-allowed" disabled>Already Requested</button>
								{%endif%}
							</div>
						</div>
					</div>
					{% if forloop.counter0|add:1|divisibleby:3 %}
					</div>
					
				{% endif %}
			{% endfor %}
		{% else %}
			<div class="alert alert-danger" role="alert">
				<strong>No Books found.</strong>
			</div>
		{% endif %}
	</div>